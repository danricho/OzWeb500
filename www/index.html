<!doctype html>
<html lang="en-US">
<head>
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8">
  <title>OzWeb500</title>
  <link rel="stylesheet" type="text/css" href="css/style.css">
  <link rel="stylesheet" type="text/css" href="css/cards.css" />
  <link rel="stylesheet" type="text/css" href="css/jquery.growl.css" />
  <link href="http://maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css" rel="stylesheet">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
  <script type="text/javascript" charset="utf-8" src="js/jquery.leanModal.mod.min.js"></script>
  <script type="text/javascript" charset="utf-8" src="js/jquery.filter_input.mod.js"></script>
  <script type="text/javascript" charset="utf-8" src="js/jquery.growl.js" ></script>
</head>
<body>
  <div id="header">
    <div class="third-column-left">
      <i id="users" class="fa fa-fw fa-users"></i>
      <i id="login_status" class="fa fa-fw fa-user red" title='Not logged in.'></i>
      <span id="usernameDisp"></span>
    </div>
    <div class="third-column-centre">
      <span id="title">OzWeb500</span>
    </div>
    <div class="third-column-right">
      <i id="ws_conn_status" class="fa fa-fw fa-plug red" title='Not Connected to Server.'></i>
    </div>
  </div>
  <div id="table">
    <div id="table_cards">
      <div class="table_card red" id="partnerTableCard">
        <div class="cardFaces">
          <div class="front">
            <div class="index"><p>10</p><p>♥</p></div>
            <div class="big"><p>10</p><p>♥</p></div>
          </div>
          <div class="back"><div class="shading"></div></div>
        </div>
      </div>
      <div class="table_card red" id="previousTableCard">
        <div class="cardFaces">
          <div class="front">
            <div class="index"><p>10</p><p>♥</p></div>
            <div class="big"><p>10</p><p>♥</p></div>
          </div>
          <div class="back"><div class="shading"></div></div>
        </div>
      </div>
      <div class="table_card red" id="nextTableCard">
        <div class="cardFaces">
          <div class="front">
            <div class="index"><p>10</p><p>♥</p></div>
            <div class="big"><p>10</p><p>♥</p></div>
          </div>
          <div class="back"><div class="shading"></div></div>
        </div>
      </div>
      <div class="table_card red" id="myTableCard">
        <div class="cardFaces">
          <div class="front">
            <div class="index"><p>10</p><p>♥</p></div>
            <div class="big"><p>10</p><p>♥</p></div>
          </div>
          <div class="back"><div class="shading"></div></div>
        </div>
      </div>
    </div>
    <figure class="Hand" id="partnerHand">
      <div class="cardPosition red" id="card_1">
        <div class="cardFaces flipped">
          <div class="front">
            <div class="index"><p>10</p><p>♥</p></div>
            <div class="big"><p>10</p><p>♥</p></div>
          </div>
          <div class="back"><div class="shading"></div></div>
        </div>
      </div>
      <div class="cardPosition red" id="card_2">
        <div class="cardFaces flipped">
          <div class="front">
            <div class="index"><p>10</p><p>♥</p></div>
            <div class="big"><p>10</p><p>♥</p></div>
          </div>
          <div class="back"><div class="shading"></div></div>
        </div>
      </div>
      <div class="cardPosition red" id="card_3">
        <div class="cardFaces flipped">
          <div class="front">
            <div class="index"><p>10</p><p>♥</p></div>
            <div class="big"><p>10</p><p>♥</p></div>
          </div>
          <div class="back"><div class="shading"></div></div>
        </div>
      </div>
      <div class="cardPosition red" id="card_4">
        <div class="cardFaces flipped">
          <div class="front">
            <div class="index"><p>10</p><p>♥</p></div>
            <div class="big"><p>10</p><p>♥</p></div>
          </div>
          <div class="back"><div class="shading"></div></div>
        </div>
      </div>
      <div class="cardPosition red" id="card_5">
        <div class="cardFaces flipped">
          <div class="front">
            <div class="index"><p>10</p><p>♥</p></div>
            <div class="big"><p>10</p><p>♥</p></div>
          </div>
          <div class="back"><div class="shading"></div></div>
        </div>
      </div>
      <div class="cardPosition red" id="card_6">
        <div class="cardFaces flipped">
          <div class="front">
            <div class="index"><p>10</p><p>♥</p></div>
            <div class="big"><p>10</p><p>♥</p></div>
          </div>
          <div class="back"><div class="shading"></div></div>
        </div>
      </div>
      <div class="cardPosition red" id="card_7">
        <div class="cardFaces flipped">
          <div class="front">
            <div class="index"><p>10</p><p>♥</p></div>
            <div class="big"><p>10</p><p>♥</p></div>
          </div>
          <div class="back"><div class="shading"></div></div>
        </div>
      </div>
      <div class="cardPosition red" id="card_8">
        <div class="cardFaces flipped">
          <div class="front">
            <div class="index"><p>10</p><p>♥</p></div>
            <div class="big"><p>10</p><p>♥</p></div>
          </div>
          <div class="back"><div class="shading"></div></div>
        </div>
      </div>
      <div class="cardPosition red" id="card_9">
        <div class="cardFaces flipped">
          <div class="front">
            <div class="index"><p>10</p><p>♥</p></div>
            <div class="big"><p>10</p><p>♥</p></div>
          </div>
          <div class="back"><div class="shading"></div></div>
        </div>
      </div>
      <div class="cardPosition red" id="card_10">
        <div class="cardFaces flipped">
          <div class="front">
            <div class="index"><p>10</p><p>♥</p></div>
            <div class="big"><p>10</p><p>♥</p></div>
          </div>
          <div class="back"><div class="shading"></div></div>
        </div>
      </div>
      <!-- kitty cards -->
      <div class="kitty cardPosition red" id="card_11">
        <div class="cardFaces flipped">
          <div class="front">
            <div class="index"><p>10</p><p>♥</p></div>
            <div class="big"><p>10</p><p>♥</p></div>
          </div>
          <div class="back"><div class="shading"></div></div>
        </div>
      </div>
      <div class="kitty cardPosition red" id="card_12">
        <div class="cardFaces flipped">
          <div class="front">
            <div class="index"><p>10</p><p>♥</p></div>
            <div class="big"><p>10</p><p>♥</p></div>
          </div>
          <div class="back"><div class="shading"></div></div>
        </div>
      </div>
      <div class="kitty cardPosition red" id="card_13">
        <div class="cardFaces flipped">
          <div class="front">
            <div class="index"><p>10</p><p>♥</p></div>
            <div class="big"><p>10</p><p>♥</p></div>
          </div>
          <div class="back"><div class="shading"></div></div>
        </div>
      </div>
      <!-- end kitty cards -->
    </figure>
    <figure class="Hand" id="previousHand">
      <div class="cardPosition red" id="card_1">
        <div class="cardFaces flipped">
          <div class="front">
            <div class="index"><p>10</p><p>♥</p></div>
            <div class="big"><p>10</p><p>♥</p></div>
          </div>
          <div class="back"><div class="shading"></div></div>
        </div>
      </div>
      <div class="cardPosition red" id="card_2">
        <div class="cardFaces flipped">
          <div class="front">
            <div class="index"><p>10</p><p>♥</p></div>
            <div class="big"><p>10</p><p>♥</p></div>
          </div>
          <div class="back"><div class="shading"></div></div>
        </div>
      </div>
      <div class="cardPosition red" id="card_3">
        <div class="cardFaces flipped">
          <div class="front">
            <div class="index"><p>10</p><p>♥</p></div>
            <div class="big"><p>10</p><p>♥</p></div>
          </div>
          <div class="back"><div class="shading"></div></div>
        </div>
      </div>
      <div class="cardPosition red" id="card_4">
        <div class="cardFaces flipped">
          <div class="front">
            <div class="index"><p>10</p><p>♥</p></div>
            <div class="big"><p>10</p><p>♥</p></div>
          </div>
          <div class="back"><div class="shading"></div></div>
        </div>
      </div>
      <div class="cardPosition red" id="card_5">
        <div class="cardFaces flipped">
          <div class="front">
            <div class="index"><p>10</p><p>♥</p></div>
            <div class="big"><p>10</p><p>♥</p></div>
          </div>
          <div class="back"><div class="shading"></div></div>
        </div>
      </div>
      <div class="cardPosition red" id="card_6">
        <div class="cardFaces flipped">
          <div class="front">
            <div class="index"><p>10</p><p>♥</p></div>
            <div class="big"><p>10</p><p>♥</p></div>
          </div>
          <div class="back"><div class="shading"></div></div>
        </div>
      </div>
      <div class="cardPosition red" id="card_7">
        <div class="cardFaces flipped">
          <div class="front">
            <div class="index"><p>10</p><p>♥</p></div>
            <div class="big"><p>10</p><p>♥</p></div>
          </div>
          <div class="back"><div class="shading"></div></div>
        </div>
      </div>
      <div class="cardPosition red" id="card_8">
        <div class="cardFaces flipped">
          <div class="front">
            <div class="index"><p>10</p><p>♥</p></div>
            <div class="big"><p>10</p><p>♥</p></div>
          </div>
          <div class="back"><div class="shading"></div></div>
        </div>
      </div>
      <div class="cardPosition red" id="card_9">
        <div class="cardFaces flipped">
          <div class="front">
            <div class="index"><p>10</p><p>♥</p></div>
            <div class="big"><p>10</p><p>♥</p></div>
          </div>
          <div class="back"><div class="shading"></div></div>
        </div>
      </div>
      <div class="cardPosition red" id="card_10">
        <div class="cardFaces flipped">
          <div class="front">
            <div class="index"><p>10</p><p>♥</p></div>
            <div class="big"><p>10</p><p>♥</p></div>
          </div>
          <div class="back"><div class="shading"></div></div>
        </div>
      </div>
      <!-- kitty cards -->
      <div class="kitty cardPosition red" id="card_11">
        <div class="cardFaces flipped">
          <div class="front">
            <div class="index"><p>10</p><p>♥</p></div>
            <div class="big"><p>10</p><p>♥</p></div>
          </div>
          <div class="back"><div class="shading"></div></div>
        </div>
      </div>
      <div class="kitty cardPosition red" id="card_12">
        <div class="cardFaces flipped">
          <div class="front">
            <div class="index"><p>10</p><p>♥</p></div>
            <div class="big"><p>10</p><p>♥</p></div>
          </div>
          <div class="back"><div class="shading"></div></div>
        </div>
      </div>
      <div class="kitty cardPosition red" id="card_13">
        <div class="cardFaces flipped">
          <div class="front">
            <div class="index"><p>10</p><p>♥</p></div>
            <div class="big"><p>10</p><p>♥</p></div>
          </div>
          <div class="back"><div class="shading"></div></div>
        </div>
      </div>
      <!-- end kitty cards -->
    </figure>
    <figure class="Hand" id="nextHand">
      <div class="cardPosition red" id="card_1">
        <div class="cardFaces flipped">
          <div class="front">
            <div class="index"><p>10</p><p>♥</p></div>
            <div class="big"><p>10</p><p>♥</p></div>
          </div>
          <div class="back"><div class="shading"></div></div>
        </div>
      </div>
      <div class="cardPosition red" id="card_2">
        <div class="cardFaces flipped">
          <div class="front">
            <div class="index"><p>10</p><p>♥</p></div>
            <div class="big"><p>10</p><p>♥</p></div>
          </div>
          <div class="back"><div class="shading"></div></div>
        </div>
      </div>
      <div class="cardPosition red" id="card_3">
        <div class="cardFaces flipped">
          <div class="front">
            <div class="index"><p>10</p><p>♥</p></div>
            <div class="big"><p>10</p><p>♥</p></div>
          </div>
          <div class="back"><div class="shading"></div></div>
        </div>
      </div>
      <div class="cardPosition red" id="card_4">
        <div class="cardFaces flipped">
          <div class="front">
            <div class="index"><p>10</p><p>♥</p></div>
            <div class="big"><p>10</p><p>♥</p></div>
          </div>
          <div class="back"><div class="shading"></div></div>
        </div>
      </div>
      <div class="cardPosition red" id="card_5">
        <div class="cardFaces flipped">
          <div class="front">
            <div class="index"><p>10</p><p>♥</p></div>
            <div class="big"><p>10</p><p>♥</p></div>
          </div>
          <div class="back"><div class="shading"></div></div>
        </div>
      </div>
      <div class="cardPosition red" id="card_6">
        <div class="cardFaces flipped">
          <div class="front">
            <div class="index"><p>10</p><p>♥</p></div>
            <div class="big"><p>10</p><p>♥</p></div>
          </div>
          <div class="back"><div class="shading"></div></div>
        </div>
      </div>
      <div class="cardPosition red" id="card_7">
        <div class="cardFaces flipped">
          <div class="front">
            <div class="index"><p>10</p><p>♥</p></div>
            <div class="big"><p>10</p><p>♥</p></div>
          </div>
          <div class="back"><div class="shading"></div></div>
        </div>
      </div>
      <div class="cardPosition red" id="card_8">
        <div class="cardFaces flipped">
          <div class="front">
            <div class="index"><p>10</p><p>♥</p></div>
            <div class="big"><p>10</p><p>♥</p></div>
          </div>
          <div class="back"><div class="shading"></div></div>
        </div>
      </div>
      <div class="cardPosition red" id="card_9">
        <div class="cardFaces flipped">
          <div class="front">
            <div class="index"><p>10</p><p>♥</p></div>
            <div class="big"><p>10</p><p>♥</p></div>
          </div>
          <div class="back"><div class="shading"></div></div>
        </div>
      </div>
      <div class="cardPosition red" id="card_10">
        <div class="cardFaces flipped">
          <div class="front">
            <div class="index"><p>10</p><p>♥</p></div>
            <div class="big"><p>10</p><p>♥</p></div>
          </div>
          <div class="back"><div class="shading"></div></div>
        </div>
      </div>
      <!-- kitty cards -->
      <div class="kitty cardPosition red" id="card_11">
        <div class="cardFaces flipped">
          <div class="front">
            <div class="index"><p>10</p><p>♥</p></div>
            <div class="big"><p>10</p><p>♥</p></div>
          </div>
          <div class="back"><div class="shading"></div></div>
        </div>
      </div>
      <div class="kitty cardPosition red" id="card_12">
        <div class="cardFaces flipped">
          <div class="front">
            <div class="index"><p>10</p><p>♥</p></div>
            <div class="big"><p>10</p><p>♥</p></div>
          </div>
          <div class="back"><div class="shading"></div></div>
        </div>
      </div>
      <div class="kitty cardPosition red" id="card_13">
        <div class="cardFaces flipped">
          <div class="front">
            <div class="index"><p>10</p><p>♥</p></div>
            <div class="big"><p>10</p><p>♥</p></div>
          </div>
          <div class="back"><div class="shading"></div></div>
        </div>
      </div>
      <!-- end kitty cards -->
    </figure>
    <figure class="Hand" id="myHand">
      <!-- kitty cards -->
      <div class="kitty cardPosition red" id="card_11">
        <div class="cardFaces">
          <div class="front">
            <div class="index"><p>10</p><p>♥</p></div>
            <div class="big"><p>10</p><p>♥</p></div>
          </div>
          <div class="back"><div class="shading"></div></div>
        </div>
      </div>
      <div class="kitty cardPosition red" id="card_12">
        <div class="cardFaces">
          <div class="front">
            <div class="index"><p>10</p><p>♥</p></div>
            <div class="big"><p>10</p><p>♥</p></div>
          </div>
          <div class="back"><div class="shading"></div></div>
        </div>
      </div>
      <div class="kitty cardPosition red" id="card_13">
        <div class="cardFaces">
          <div class="front">
            <div class="index"><p>10</p><p>♥</p></div>
            <div class="big"><p>10</p><p>♥</p></div>
          </div>
          <div class="back"><div class="shading"></div></div>
        </div>
      </div>
      <!-- end kitty cards -->
      <div class="cardPosition red" id="card_1">
        <div class="cardFaces">
          <div class="front">
            <div class="index"><p>10</p><p>♥</p></div>
            <div class="big"><p>10</p><p>♥</p></div>
          </div>
          <div class="back"><div class="shading"></div></div>
        </div>
      </div>
      <div class="cardPosition red" id="card_2">
        <div class="cardFaces">
          <div class="front">
            <div class="index"><p>10</p><p>♥</p></div>
            <div class="big"><p>10</p><p>♥</p></div>
          </div>
          <div class="back"><div class="shading"></div></div>
        </div>
      </div>
      <div class="cardPosition red" id="card_3">
        <div class="cardFaces">
          <div class="front">
            <div class="index"><p>10</p><p>♥</p></div>
            <div class="big"><p>10</p><p>♥</p></div>
          </div>
          <div class="back"><div class="shading"></div></div>
        </div>
      </div>
      <div class="cardPosition red" id="card_4">
        <div class="cardFaces">
          <div class="front">
            <div class="index"><p>10</p><p>♥</p></div>
            <div class="big"><p>10</p><p>♥</p></div>
          </div>
          <div class="back"><div class="shading"></div></div>
        </div>
      </div>
      <div class="cardPosition red" id="card_5">
        <div class="cardFaces">
          <div class="front">
            <div class="index"><p>10</p><p>♥</p></div>
            <div class="big"><p>10</p><p>♥</p></div>
          </div>
          <div class="back"><div class="shading"></div></div>
        </div>
      </div>
      <div class="cardPosition red" id="card_6">
        <div class="cardFaces">
          <div class="front">
            <div class="index"><p>10</p><p>♥</p></div>
            <div class="big"><p>10</p><p>♥</p></div>
          </div>
          <div class="back"><div class="shading"></div></div>
        </div>
      </div>
      <div class="cardPosition red" id="card_7">
        <div class="cardFaces">
          <div class="front">
            <div class="index"><p>10</p><p>♥</p></div>
            <div class="big"><p>10</p><p>♥</p></div>
          </div>
          <div class="back"><div class="shading"></div></div>
        </div>
      </div>
      <div class="cardPosition red" id="card_8">
        <div class="cardFaces">
          <div class="front">
            <div class="index"><p>10</p><p>♥</p></div>
            <div class="big"><p>10</p><p>♥</p></div>
          </div>
          <div class="back"><div class="shading"></div></div>
        </div>
      </div>
      <div class="cardPosition red" id="card_9">
        <div class="cardFaces">
          <div class="front">
            <div class="index"><p>10</p><p>♥</p></div>
            <div class="big"><p>10</p><p>♥</p></div>
          </div>
          <div class="back"><div class="shading"></div></div>
        </div>
      </div>
      <div class="cardPosition red" id="card_10">
        <div class="cardFaces">
          <div class="front">
            <div class="index"><p>10</p><p>♥</p></div>
            <div class="big"><p>10</p><p>♥</p></div>
          </div>
          <div class="back"><div class="shading"></div></div>
        </div>
      </div>
    </figure>
  </div>
  <div id="footer">
    <div class="half-column-left">
      &nbsp;
    </div>
    <div class="half-column-right">
      <input type="text" name="inputChat" id="inputChat" tabindex="3" value="" class="grey" disabled>
    </div>
  </div>
  <div id="loginmodal" style="display:none;">
    <p class="bigger">Welcome to OzWeb500!</p>
    <p>Enter your desired username.</p>
    <input type="text" name="inputUsername" id="inputUsername" tabindex="1" value="" class="grey">
    <input type="button" name="buttonLogin" id="buttonLogin" value="Log In" tabindex="2">
    <p id="feedbackLogin" class="red" style="display:none;">&nbsp;</p>
    
    <a href="#loginmodal" rel="leanModal" name="loginmodal" style="display:none" id="modaltrigger">a</a>
    <a href="#loginmodal" rel="leanModal" name="loginmodal" id="hide_modal" style="display:none">a</a>
  </div>
  <div id="userList"></div>
  <script type="text/javascript">

    client_version = 0.1

    function doWsConnect(){
      websocket = new WebSocket("ws://"+window.location.hostname+":"+"8000");
      websocket.onopen = function(evt) { onWebSockOpen(evt) };
      websocket.onclose = function(evt) { onWebSockClose(evt) };
      websocket.onmessage = function(evt) { onWebSockMessage(evt) };
      websocket.onerror = function(evt) { onWebSockError(evt) };
    }
    function doWsDisconnect(){
      websocket.close();
    }
    function doWsSend(type, dataIn){
      message = {header:type, data:dataIn}
      websocket.send(JSON.stringify(message));
      console.groupCollapsed("WS Sent: %s.", message.header);
      console.log("Sent Data:", message.data);
      console.groupEnd();
    }
    function doLoginRequest(){
      var desired_username = $("#inputUsername").val();
      console.groupCollapsed("Attempting Login as '%s'.", desired_username);
      if (desired_username == "") {
        console.log("Username Empty: Setting Feedback.");
        doUpdateLoginFeedback("Enter a username!", true);
        console.groupEnd();
      }else if(desired_username.length < 3){
        console.log("Username too short: Setting Feedback.");
        doUpdateLoginFeedback("Username is too short (min 3).", true);
        console.groupEnd();
      }else if(desired_username.length > 10){
        console.log("Username too long: Setting Feedback.");
        doUpdateLoginFeedback("Username is too long (max 10).", true);
        console.groupEnd();
      }else{
        console.log("Sending usernameRequest message.");
        doUpdateLoginFeedback("Requesting username...", false);
        console.groupEnd();
        doWsSend("usernameRequest", desired_username);
      }
    }
    function doSendChatMessage(){
      doWsSend("chat", $('#inputChat').val());
    }
    function doModal(state){
      if (state){
        $("#modaltrigger").click();
      }else{
        doClearLoginFeedback();
        $("#hide_modal").click();
      }
    }
    function doChatInputState(state){
      if (state){
        $("#inputChat").prop('disabled', false);
      }else{
        $("#inputChat").prop('disabled', true);
      }
    }
    function doUpdateLoginFeedback(str, red){
      if (red) {
        $("#feedbackLogin").html(str).addClass("red").show();
      }else{
        $("#feedbackLogin").html(str).removeClass("red").show();
      }
    }
    function doClearLoginFeedback(){
        $("#feedbackLogin").html("").removeClass("red").show();
    }
    function doUpdateConnectionStatus(status){
      if (status){
        $("#ws_conn_status").removeClass("red").attr('title', 'Connected to Server.');
      }else{
        $("#ws_conn_status").addClass("red").attr('title', 'Not Connected to Server.');
      }
    }
    function doUpdateLoginStatus(username){
      if (username==""){
        $("#usernameDisp").text("");
        $("#login_status").addClass("red").attr('title', 'Not logged in.');
      }else{
        $("#usernameDisp").text(username);
        $("#login_status").removeClass("red").attr('title', 'Logged in as '+username+'.');
      }
    }
    function doUpdateVersionInfo(server_version, client_version){
      $("#title").attr('title', "Server v" + server_version + " : Client v" + client_version);
    }
    function doUpdatePageTitle(username){
      if (username==""){
        document.title = "OzWeb500";
      }else{
        document.title = "OzWeb500 : " + username;
      }
    }
    function doUpdateUserList(users){
      $("#userList").html("");
      $.each(users, function( index, value ) {
        $("#userList").append( "<p>"+value+"</p>" );
      });
    }
    
    function onWebSockOpen(evt){ 
      console.groupCollapsed("WS connection successfully opened.");
      console.log("Updating the connection status display to 'connected'.");
      doUpdateConnectionStatus(true);
      console.log("Open Event Data:", evt);
      console.groupEnd();
    }
    function onWebSockClose(evt){
      console.groupCollapsed("WS connection closed.");
      console.log("Updating the connection status display to 'not connected'.");
      doUpdateConnectionStatus(false);
      console.log("Updating the login status to 'not logged in'.");
      doUpdateLoginStatus("");
      console.log("Updating the page title to 'OzWeb500'.");
      doUpdatePageTitle("");
      console.log("Hiding the login modal.");
      doModal(false)
      console.log("Disabling chat input.");
      doChatInputState(false);
      console.log("Close Event Data",evt)
      console.groupEnd();
      
      setTimeout(function(){ doWsConnect(); }, 2500);
      
    }
    function onWebSockMessage(evt){
      message = jQuery.parseJSON(evt.data);
      console.groupCollapsed("WS Rcvd: %s.", message.header);
      switch (message.header){
        case "serverVersion":
          console.log("Updating the title version data to 'Server v" + message.data + " : Client v" + client_version+ "'.");
          doUpdateVersionInfo(message.data, client_version)
          console.groupEnd();
          break;
        case "ping":
          console.log("Sending pong message.");
          console.groupEnd();
          doWsSend("pong",message.data);
          break;
        case "loginRequest":
          console.log("Showing the login modal.");
          doModal(true);
          console.groupEnd();
          break;
        case "usernameExists":
          console.log("Displaying login feedback (in red).");
          doUpdateLoginFeedback( $("#inputUsername").val() + " is already logged in!", true );
          console.log("Clearing the entered username.");
          $("#inputUsername").val("");
          console.groupEnd();
          break;
        case "loginAccepted":
          username = message.data;
          console.log("In 1 second:");
          console.log(" - Displaying login feedback (not red).");
          console.log(" - Updating the login status to 'logged in'.");
          console.log(" - Updating the page title to 'OzWeb500 : "+username+"'.");
          console.log(" - Enabling chat input.");
          console.log("In 2.5 seconds:");
          console.log(" - Hiding the login modal.");
          console.groupEnd();
          setTimeout(function(){
            doUpdateLoginFeedback( "Login Successful.", false);
            doUpdateLoginStatus(username);
            doUpdatePageTitle(username);
            doChatInputState(true);
          }, 1000);
          setTimeout(function(){ doModal(false); }, 2500);
          break;
        case "userList":
          console.log("Updating user list.");
          doUpdateUserList(message.data);
          console.log("Received Data: ", message.data);
          console.groupEnd();
          break;
        case "chatMessage":
          console.log("From: "+message.data.fromUser+".");
          console.log("Message: " +message.data.message+".");
          console.log("Displaying message.");
          onIncomingChatMessage(message.data.fromUser, message.data.message);
        default:
          console.log("Received Data: ", message.data);
          console.groupEnd();
      }      
      
    }
    function onWebSockError(evt){
      console.groupCollapsed("WS connection error.");
      console.log("Error Event Data:", evt);
      console.groupEnd();
    }
    function onIncomingChatMessage(from, msg){
      $.growl({ title: from+":", message: msg });
    }
    
    $(document).ready(function() {
      doWsConnect();
      $("#modaltrigger").leanModal({ top: 200, overlay: 0.7, closeButton: "#hide_modal" });
      $("#buttonLogin").click(doLoginRequest);
      $("#inputUsername").filter_input({
        regex:'[a-zA-Z0-9_]', 
        disallowed_feedback: function(char) {
          if (char.charCodeAt(0) == 13){ //enter press
            $("#buttonLogin").click();
          }else{
            if (char==" "){ char = "Spaces" }
            else { char = "'" + char + "'" }
            $("#feedbackLogin").html(char + " not allowed.").addClass("red").show();
          }
        },
        allowed_feedback: function(char) {
          if (char==" "){ char = "Spaces" }
          else { char = "'" + char + "'" }
          $("#feedbackLogin").html("").removeClass("red").hide();
        }
      });
      $("#users").hover(function() {
          if ($("#usernameDisp").text() != ""){$("#userList").show();}
        }, function() { $("#userList").hide();
      });
      $('#inputChat').keypress(function (e) {
        if (e.which == 13) {
          doSendChatMessage();
          $('#inputChat').val("");
        }
      });
      $( ".cardFaces" ).each(function(index) {
        $(this).on("click", function(){
          $(this).toggleClass('flipped');
        });
      });
    });
    
  </script>

</body>
</html>